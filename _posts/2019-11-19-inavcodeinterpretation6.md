---  
layout: post  
title:  "inav代码解读6 - inav的其他任务"  
date:  2019-11-19 19:32:13  
categories: 无人机  
tags: UAV inav  
---  

* content  
{:toc} 

本节主要内容是除主任务外的其他任务，只对两个任务进行介绍。

### 接收机任务
遥控器接收机的处理流程，核心处理函数是位于```./src/main/gc/fc_core.c```中的```processRx()```。该任务主要是负责对接收到的多个通道进行处理，包括失控保护，飞行模式，解锁等  
inav支持两种解锁方式，一种是通过一个辅助通道进行解锁，另一种是通过摇杆进行解锁，主要是通过```isUsingSticksForArming()```进行判断。  
当未接收到接收机数据，或者接收机模式拨到失控保护时，将进入失控保护模式。如果固件开启了导航模块，那将按照设置进行降落或者返航。如果进入失控返航模式，那就会强制进入导航模式中的失控返航模式  

此外，在该任务中还对根据当前的辅助通道信息进行飞行模式的判断（注意飞行模式有别于导航模式，由于inav的导航模块独立，因此两者互不干扰，但是如果有冲突，一般导航模式会覆盖飞行模式的效果）  

### 串口处理任务
飞控与电脑等的通讯都是通过msp协议来进行处理，串口处理任务主要是```mspSerialProcess()```，在该个函数内主要处理msp消息，当收到msp消息时，将会进行反馈  

inav的固件主要就介绍到这了，希望想改F3固件的时候，能快捷的进行功能开发。如果有错误，希望指出。
